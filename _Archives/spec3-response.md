ご指摘に対する回答

1.1

集会（イベント）テーブル 
集会そのもの（例：2025-02-02 調布地区集会）を登録するテーブル・作成フローの仕様を定義して下さい。

レギュラーメンバーリストの構造
テーブル名・カラム（集会ID、メンバーID、並び順等）を記載してください。
並び順は読み仮名、登録順、信仰順と選択できるようにして下さい。

ユーザー・ロールのテーブル
管理者・共同管理者・報告者・閲覧者のアカウント、ロール、報告者の所属地区をどこに持つか、合理的に記載してください。


メンバーの所属（地区）
「このメンバーがどの地区に属するか」を明示する district_id を members に持たせます。
なお、データ上、地区→小組はだぶりなく分けますが、レギュラーメンバーリスト作成時は全地方から選ぶことができる。

vital_group の実体
単に「メンバーIDのリスト」をJSON等で持ちます。
→vital_groupのグラフィックビュー（Obsidianのように）が欲しい。

1.2
聖徒 / 友人： バプテスマ済み＝聖徒・未＝友人でよい
欠席アラートの「X」：初期設定は4、1〜52までドロップダウンで選べる。
「子供」の範囲：小学生まで

1.3 フロー・画面
報告者の承認フロー ：管理者がメールで追加するだけ。
初回ログイン（アクティベート）されたら管理者にメールを送ること。
（メール報告パターン：報告者/閲覧者→管理者/共同管理者、共同管理者→管理者）

1.4 非機能要件
監査ログ： 誰がいつ・どのデータを変更したかの記録が必要です。
ログインログも欲しい、共同管理者以上が見れるようにする。

同時編集・競合
同じ集会の出席を複数人が同時に報告した場合の扱い（ロック、マージ、後勝ち等）が未定義。
報告時に、提出をストップし、重複の名前をアラートに出す：
　XXさんは報告者「OO」さんによって登録済みです。
なお、同じ日の地区集会において、ダブル出席は認められませんので、万が一登録しようとした場合、アラートを出す」
　XXさんは同日の「▽▽地区集会」に「OO」さんによって登録済みです。

バックアップ・リストア
欲しいので、実装するようにしてください。

UI言語
日本語のみでよい。


2.1 参照番号の誤り
修正してください

attendance_records の district_id / group_id：
地区・小組とも「報告時点の所属」とする。いずれも変わる可能性があるため

2.3 権限・運用の解釈のぶれ
報告者の所属： 報告者が「複数地区を担当可」とします。初期表示を「メイン担当地区」にする。
初期設定では、地方内の全地区を担当可能とする。将来的に一部の地区を権限から除外できる仕組みはほしい。
つまり、担当地区がチェックボックス形式で選べるが、初期状態はすべてにチェックが入った状態だ。

小組の作成者：共同管理者もOとします。

3\. エッジケース・例外処理（未定義）
最後の1人の管理者： 管理者が自分を削除したりロール変更したりして、管理者が0人にならないようにする制御を入れてください。

小組・地区の削除： 
小組を削除した場合、所属メンバーを無所属リストに移す。
地区を削除する場合、下位の小組・集会・出席履歴は過去の事実なので変更されない。

名簿統合の取り消し
統合を誤った場合のロールバックや、統合履歴の保持がほしい。

メール送信失敗
報告者追加時のパスワード通知メールが失敗した場合の再送・手順がほしい。

重複ログイン・セッション
同一アカウントの複数デバイス・タブの扱い：許可する


4\. 仕様の明確化を推奨する点

1. 「集会」をファーストクラスのエンティティとして定義する→ご推奨の通りにしてください
2. 報告者と地区の紐付けを明示する→全地区に登録する権限はあるが、初期に表示されるメイン地区を設ける。
3. 聖徒/友人の定義を1行で書く→「バプテスマ済みを聖徒、未を友人として統計に使用する」としてください。
4. 共同管理者が小組を作成できるかどうかを権限と文章で一致させる→できる
5. ゲストの小組所属→ゲストは地方のメンバーではないので、所属させない。
6. 閲覧者が見られる範囲→地区・小組を選んで見られる。
